(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/register/index"],{"0460":function(e,t,r){"use strict";(function(e){r("d394"),r("921b");i(r("66fd"));var t=i(r("26be"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("c11b")["createPage"])},"1baf":function(e,t,r){"use strict";r.r(t);var i=r("e59a"),a=r.n(i);for(var n in i)"default"!==n&&function(e){r.d(t,e,function(){return i[e]})}(n);t["default"]=a.a},"26be":function(e,t,r){"use strict";r.r(t);var i=r("27e5"),a=r("1baf");for(var n in a)"default"!==n&&function(e){r.d(t,e,function(){return a[e]})}(n);var s,o=r("f0c5"),d=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=d.exports},"27e5":function(e,t,r){"use strict";var i,a=function(){var e=this,t=e.$createElement;e._self._c},n=[];r.d(t,"b",function(){return a}),r.d(t,"c",function(){return n}),r.d(t,"a",function(){return i})},e59a:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{barColor:this.barColor,bgColor:this.bgColor,requestParams:{},areaArray:[["省"],["市"],["区"]],areaIndex:[0,0,0],communitys:[],communityPicker:["请先选择街道"],communityid:"",communityindex:0,streets:[],streetPicker:["请先选择区划"],streetid:"",streetindex:0,villages:[],villagePicker:["请先选择社区"],villageid:"",villageindex:0,floorlist:[],multiArray:[["楼号"],["楼层"],["单元"]],multiIndex:[0,0,0],rooms:[],roomsPicker:["请选择房间"],room_id:"",roomindex:0,entry:{},warnmsg:"",adcodeid:"",scantype:"",areas:{},provinceIndex:0,cityIndex:0,countyIndex:0,floorIndex:0,unitsIndex:0,layersIndex:0}},onLoad:function(t){var r=this,i=t.codecontent;if(i&&null!=i){t.codecontent=decodeURIComponent(t.codecontent);var a=t.codecontent.split("_");if(2==a.length){var n=a[1];return this.scantype=n,"物业"==n?(this.villageid=a[0],this.villageChange(),t.registertype="业主"):"社区"==n&&(this.communityid=a[0],this.communityChange(),t.registertype="物业"),void(this.requestParams=t)}this.$common.errorToShow("解码失败",function(){e.navigateBack({})})}else t.registertype=decodeURIComponent(t.registertype);this.requestParams=t,this.$common.loadToShow("正在定位中...."),this.areas=this.$api.getAreas();var s=new Object;s.success=function(e){r.$api.baidu({location:e.latitude+","+e.longitude},function(e){if(console.log("获取地址====="+JSON.stringify(e)),r.$common.loadToHide(),e)if(0==e.status){var t=e.result,i=t.addressComponent.town_code;r.initdatas(i)}else r.initdatas();else r.initdatas()})},s.fail=function(e){r.$common.loadToHide(),r.initdatas(),r.$common.errorToShow("定位失败"+JSON.stringify(e))},e.getLocation(s)},methods:{provinceChange:function(e){this.provinceIndex=e.detail.value;var t=new Array;t[0]=this.areaArray[0],t[1]=this.entryArray(this.areas[this.provinceIndex].children),t[2]=this.entryArray(this.areas[this.provinceIndex].children[0].children),this.areaArray=t,this.areaIndex[0]=this.provinceIndex,this.AreaChange()},cityChange:function(e){this.cityIndex=e.detail.value;var t=new Array;t[0]=this.areaArray[0],t[1]=this.areaArray[1],t[2]=this.entryArray(this.areas[this.provinceIndex].children[this.cityIndex].children),this.areaArray=t,this.areaIndex[1]=this.cityIndex,this.AreaChange()},countyChange:function(e){this.countyIndex=e.detail.value,this.areaIndex[2]=this.countyIndex,this.AreaChange()},floorChange:function(e){this.floorIndex=e.detail.value;var t=new Array;t[0]=this.f[0],t[1]=this.entryArray(this.multiArray[this.floorIndex].children),t[2]=this.entryArray(this.multiArray[this.floorIndex].children[0].children),this.areaArray=t,this.multiIndex[0]=this.floorIndex,this.AreaChange()},unitsChange:function(e){this.unitsIndex=e.detail.value;var t=new Array;t[0]=this.areaArray[0],t[1]=this.areaArray[1],t[2]=this.entryArray(this.multiArray[this.floorIndex].children[this.unitsIndex].children),this.areaArray=t,this.multiIndex[1]=this.unitsIndex,this.AreaChange()},layersChange:function(e){this.layersIndex=e.detail.value,this.multiIndex[2]=this.layersIndex;var t=new Object;t.detail=new Object,t.detail["value"]=this.multiIndex,this.MultiChange(t)},initdatas:function(e){var t="",r="",i="";this.adcodeid=e,e&&e.length>=6&&(t=e.substring(0,2)+"0000",r=e.substring(0,4)+"00",i=e.substring(0,6));for(var a=new Array,n=new Array,s=new Array,o=new Array,d=0;d<this.areas.length;d++){var h=this.areas[d];if(n.push(h.name),""!=t){if(h.code==t){this.areaIndex[0]=d;for(var c=h.children,l=0;l<c.length;l++){var u=c[l];if(s.push(u.name),r==u.code){this.areaIndex[1]=l;for(var m=u.children,y=0;y<m.length;y++){var f=m[y];o.push(f.name),i==f.code&&(this.areaIndex[2]=y)}}}}}else if(0==d)for(c=this.areas[0].children,l=0;l<c.length;l++){u=c[d];if(s.push(u.name),0==l)for(m=u.children,y=0;y<m.length;y++){f=m[y];o.push(f.name)}}}a.push(n),a.push(s),a.push(o),this.areaArray=a,this.AreaChange()},villageChange:function(e){e&&(this.villageindex=e.detail.value,this.villageid=this.villages[e.detail.value].id);var t=new Object;t.id=this.villageid,t.type="4";var r=this;this.$api.arealist(t,function(e){if(e.success)if(console.log(JSON.stringify(e)),0==e.data.length)r.$common.errorToShow("未找到楼栋信息，请联系管理员加入");else{r.floorlist=e.data;var t=r.floorlist[r.multiIndex[0]],i=t.units[r.multiIndex[1]],a=r.entryArray(e.data),n=r.entryArray(t.units),s=r.entryArray(i.layers),o=new Array;o.push(a),o.push(n),o.push(s),r.multiArray=o;var d=new Object;d.detail=new Object,d.detail["value"]=r.multiIndex,r.MultiChange(d)}else r.$common.errorToShow(e.message)})},communityChange:function(e){if(e&&(this.communityindex=e.detail.value,this.communityid=this.communitys[e.detail.value].id),"业主"==this.requestParams.registertype){var t=new Object;t.id=this.communityid,t.type="3";var r=this;this.$api.arealist(t,function(e){console.log("刷新小区===="+r.communityid+"==="+JSON.stringify(e.data)),e.success?0==e.data.length?r.$common.errorToShow("未找到小区信息，请联系管理员加入"):(r.villages=e.data,r.villagePicker=r.entryArray(e.data),r.villageid=r.villages[0].id,r.villageChange()):r.$common.errorToShow(e.message)})}},streetChange:function(e){e&&(this.streetindex=e.detail.value,this.streetid=this.streets[e.detail.value].id);var t=new Object;t.id=this.streetid,t.type="2";var r=this;this.$api.arealist(t,function(e){e.success?0==e.data.length?r.$common.errorToShow("未找到社区信息，请联系管理员加入"):(r.communitys=e.data,r.communityPicker=r.entryArray(e.data),r.communityid=r.communitys[0].id,r.communityChange()):r.$common.errorToShow(e.message)})},entryArray:function(e){for(var t=new Array,r=0;r<e.length;r++){var i=e[r];t.push(i.name)}return t},MultiChange:function(e){var t=this;this.multiIndex=e.detail.value,this.layerid=this.floorlist[this.multiIndex[0]].units[this.multiIndex[1]].layers[this.multiIndex[2]].id;var r=new Object;r.id=this.layerid,r.type="5",this.$api.arealist(r,function(e){if(e.success){t.rooms=e.data;var r=t.entryArray(e.data);t.roomsPicker=r,t.room_id=t.rooms[0].id}else t.$common.errorToShow("获取楼层房间失败=="+e.message)})},MultiColumnChange:function(e){console.log("变化前===="+JSON.stringify(this.multiArray));var t={dataArray:[],dataIndex:this.multiIndex};switch(t.dataIndex[e.detail.column]=e.detail.value,e.detail.column){case 0:t.dataArray[0]=this.multiArray[0],t.dataArray[1]=this.entryArray(this.floorlist[t.dataIndex[0]].units),t.dataArray[2]=this.entryArray(this.floorlist[t.dataIndex[0]].units[0].layers),t.dataIndex[1]=0,t.dataIndex[2]=0;break;case 1:t.dataArray[0]=this.multiArray[0],t.dataArray[1]=this.multiArray[1];var r=this.floorlist[t.dataIndex[0]].units[t.dataIndex[1]].layers;t.dataArray[2]=this.entryArray(r),t.dataIndex[2]=0;break;default:t.dataArray=this.multiArray;break}this.multiArray=t.dataArray,this.multiIndex=t.dataIndex},AreaChange:function(){var e=this.areas[this.areaIndex[0]],t=e.children[this.areaIndex[1]],r=t.children[this.areaIndex[2]],i=new Object;i.id=r.code+"000000",i.type="1";var a=this;console.log(JSON.stringify(i)),this.$api.arealist(i,function(e){if(console.log(JSON.stringify(e)),e.success)if(0==e.data.length)a.$common.errorToShow("您选择的区划未找到街道信息，请联系管理员加入");else{if(a.streets=e.data,a.streetPicker=a.entryArray(e.data),a.adcodeid&&""!=a.adcodeid){for(var t=0;t<a.streets.length;t++){var r=a.streets[t];if(r.id==a.adcodeid+"000"){a.streetindex=t;break}}a.streetid=a.adcodeid+"000"}else a.streetid=a.streets[0].id;a.streetChange()}else a.$common.errorToShow(e.message)})},AreaColumnChange:function(e){var t={dataArray:[],dataIndex:this.areaIndex};switch(t.dataIndex[e.detail.column]=e.detail.value,e.detail.column){case 0:t.dataArray[0]=this.areaArray[0],t.dataArray[1]=this.entryArray(this.areas[t.dataIndex[0]].children),t.dataArray[2]=this.entryArray(this.areas[t.dataIndex[0]].children[0].children),t.dataIndex[1]=0,t.dataIndex[2]=0;break;case 1:t.dataArray[0]=this.areaArray[0],t.dataArray[1]=this.areaArray[1],t.dataArray[2]=this.entryArray(this.areas[t.dataIndex[0]].children[t.dataIndex[1]].children),t.dataIndex[2]=0;break;default:t.dataArray=this.areaArray;break}this.areaArray=t.dataArray,this.areaIndex=t.dataIndex},discriCard:function(){var e=this.entry.cardid;e.substring(6,10),e.substring(10,12),e.substring(12,14),parseInt(e.substr(16,1))%2==1?this.entry.sex="男":this.entry.sex="那个";var t=new Date,r=t.getMonth()+1,i=t.getDate(),a=t.getFullYear()-e.substring(6,10)-1;(e.substring(10,12)<r||e.substring(10,12)==r&&e.substring(12,14)<=i)&&a++,this.entry.age=a},register:function(){var t=this.requestParams.registertype,r=this.$common.isPhoneNumber(this.entry.phone);if(r)if(this.$common.isBlack(this.entry.name)){var i=this.$common.getParams("register",this.entry);i.registertype=t,i.province=this.areaArray[0][this.areaIndex[0]],i.city=this.areaArray[1][this.areaIndex[1]],i.county=this.areaArray[2][this.areaIndex[2]],i.streetid=this.streetid,i.community=this.communityid;var a=this;if("业主"==t){if(""==this.room_id)return void this.$common.errorToShow("请选择您居住房间");var n=this.$common.isCardNumber(this.entry.cardid);if(!n)return this.$common.errorToShow("请输入正确的身份证号"),void(this.idcardfocus=!0);this.discriCard(),i.age=this.entry.age,i.sex=this.entry.sex,i.roomId=this.room_id,console.log("================"+JSON.stringify(i)),this.$api.registerowner(i,function(t){t.success?a.$common.successToShow("注册成功",function(){e.navigateBack({})}):a.$common.errorToShow(t.message)})}else if("物业"==t){if(console.log("params.floor===="+i.floor),!this.$common.isInteger(i.floor))return void this.$common.errorToShow("建筑数必须是整数");if(!this.$common.isInteger(i.unit))return void this.$common.errorToShow("每栋楼拥有的单元数必须是整数");if(!this.$common.isInteger(i.layer))return void this.$common.errorToShow("每单元的楼层数必须是整数");if(!this.$common.isInteger(i.room))return void this.$common.errorToShow("每层户数必须是整数");if(i.village=i.name,""==this.communityid)return void this.$common.errorToShow("请选择您所属的社区");if(!this.$common.isBlack(this.entry.loginName))return void this.$common.errorToShow("用户名必须填写");var s=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]*$/;if(!s.test(this.entry.loginName))return void this.$common.errorToShow("用户名必须包含数字和字母");if(!this.$common.isBlack(this.entry.password))return void this.$common.errorToShow("请填写密码");if(this.entry.password!=this.entry.surepassword)return void this.$common.errorToShow("两次密码输入不一致");console.log("====="+JSON.stringify(i)),this.$api.registersys(i,function(t){t.success?a.$common.successToShow("注册成功",function(){e.navigateBack({})}):a.$common.errorToShow(t.message)})}}else this.$common.errorToShow("名字必须填写");else this.$common.errorToShow("请输入正确的手机号码")}}};t.default=r}).call(this,r("c11b")["default"])}},[["0460","common/runtime","common/vendor"]]]);